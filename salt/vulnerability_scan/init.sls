# vulnerability_scan/init.sls - SAFE VERSION

# Install security tools but don't run long scans automatically
lynis:
  pkg.installed: []

rkhunter:
  pkg.installed: []

aide:
  pkg.installed: []

# Quick security checks that won't hang
quick_security_scan:
  cmd.run:
    - name: |
        echo '=== Running quick security scan ===' > /var/log/security-scan.log
        date >> /var/log/security-scan.log
        echo 'Lynis and rkhunter installed. Run manually when needed:' >> /var/log/security-scan.log
        echo 'sudo lynis audit system --quick' >> /var/log/security-scan.log
        echo 'sudo rkhunter --check --sk' >> /var/log/security-scan.log
        echo 'Scan tools ready - run manually to avoid blocking Salt' >> /var/log/security-scan.log
    - creates: /var/log/security-scan.log

# Install basic monitoring tools
log_tools:
  pkg.installed:
    - pkgs:
      - logwatch
      - sysstat
      - htop
      - iotop
